
<html>
<head>
    <title>Tool: PGN with linebreaks</title>
    <script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
    <script
    src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
    integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/ui-lightness/jquery-ui.css"/>
  <link rel="stylesheet" href="/css/default.css"/>
  <style type="text/css">
   /*  @font-face {font-family: 'Noto Sans KR';font-style: normal;font-weight: 100;src: url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Thin.woff2) format('woff2'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Thin.woff) format('woff'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Thin.otf) format('opentype');}

    @font-face {font-family: 'Noto Sans KR';font-style: normal;font-weight: 300;src: url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Light.woff2) format('woff2'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Light.woff) format('woff'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Light.otf) format('opentype');}

    @font-face {font-family: 'Noto Sans KR';font-style: normal;font-weight: 400;src: url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Regular.woff2) format('woff2'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Regular.woff) format('woff'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Regular.otf) format('opentype');}

    @font-face {font-family: 'Noto Sans KR';font-style: normal;font-weight: 500;src: url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Medium.woff2) format('woff2'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Medium.woff) format('woff'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Medium.otf) format('opentype');}

    @font-face {font-family: 'Noto Sans KR';font-style: normal;font-weight: 700;src: url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Bold.woff2) format('woff2'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Bold.woff) format('woff'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Bold.otf) format('opentype');}

    @font-face {font-family: 'Noto Sans KR';font-style: normal;font-weight: 900;src: url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Black.woff2) format('woff2'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Black.woff) format('woff'),url(//fonts.gstatic.com/ea/notosanskr/v2/NotoSansKR-Black.otf) format('opentype');}
    body{
    text-align: center;
    font-family: 'Noto Sans KR';
    }
    nav{
    clear:both;
    display:block;
    height:100px;
    } */
    .dochange_button{
        width:90%;
        height:100px;
        clear: both;
        margin-left:5%;
        margin-right:5%;
        margin-top:20px;
        margin-bottom:20px;        
    }
    .textarea_gibo{
        width:100%;
        clear:both;
    }
  </style>
  <script type="text/javascript">
    function doRun(){
        $('#dochange').click(function(){
            let before = getBefore();
            //console.log('before=' + before);
            let after = doTransform(before);
            setAfter(after);
            setAfterLi(after);
        });
    }

    function getBefore(){
        return $('#before').val();
    }    

    function doTransform(before){
        let after = [];
        
        let bracketStart = 0;
        let bracketEnd = 0;        

        //괄호 안 내용 없애기
        for(let i = 0 ; i < before.length ; i++){
            if(before.charAt(i) == '('){
                after.push(before.slice(bracketEnd, i).split());
                bracketStart = i;
            }
            if(before.charAt(i) == ')'){
                bracketEnd = i + 1;
            }
        }
        after.push(before.slice(bracketEnd, before.length).split());

        //let reBracket = /[(].*(?:(?![(]))[)]/g;
        //let afterstr = before.replaceAll(reBracket, '');

        let afterstr = after.join('');
        after = [];

        let re = /[0-9]+[.]+[ ]/g;
        afterstr = afterstr.replaceAll(re, '\n'+'$&');
 
        return afterstr;
    }

    function setAfter(after){
        $('#after').val(after);
        $('#after').select();
        document.execCommand('copy');
    }

    function setAfterLi(after){
        const arr = after.split('\n');
        const arrli = arr.map(item => !item.startsWith('[') && item != '' && item != null ? '<li>' + item + '</li>' : item);

        const afterli = arrli.join('\n');
        $('#afterli').val(afterli);

        $('#afterli').select();
        document.execCommand('copy');
    }

    $(document).ready(function(){
        doRun();
    });
    </script>
</head>
<body>
    <%-include('menu') %>
    <canvas id="canvas" style="display:none"></canvas>
    <h1>기보 엔터 처리하기</h1>
    <h2>1. 기보 붙여넣기</h2>
    <textarea id="before" name="before" class="textarea_gibo" cols="150" rows="15"></textarea> 
    <h2>2. 변환버튼 클릭</h2>
    <button name="dochange" id="dochange" class="dochange_button">변환</button>
    <h2>3. 엔터처리된 기보</h2>
    <textarea id="after" name="after"  class="textarea_gibo" cols="150" rows="15"></textarea>
    <h2>4. li태그로 감싼 기보</h2>
    <textarea id="afterli" name="afterli"  class="textarea_gibo" cols="150" rows="15"></textarea>
</body>
</html>



